function initSlim(){$("a[rel!=link]:has(img)").filter(function(){return $(this).attr("href")===$(this).find("img").attr("src")?!0:void 0}).slimbox({loop:!0,resizeDuration:200,imageFadeDuration:200,counterText:"图片灯箱: 第{x}张 / 共{y}张",captionAnimationDuration:200})}jQuery(document).ready(initSlim),function(i){function t(){var t=K.scrollLeft(),e=K.width();i([x,z]).css("left",t+e/2),m&&i(w).css({left:t,top:K.scrollTop(),width:e,height:K.height()})}function e(e){e?i("object").add(C?"select":"embed").each(function(i,t){E[i]=[t,t.style.visibility],t.style.visibility="hidden"}):(i.each(E,function(i,t){t[0].style.visibility=t[1]}),E=[]);var o=e?"bind":"unbind";K[o]("scroll resize",t),i(document)[o]("keydown",n)}function n(t){var e=t.which,n=i.inArray;return n(e,u.closeKeys)>=0?d():n(e,u.nextKeys)>=0?a():n(e,u.previousKeys)>=0?o():null}function o(){return r(p)}function a(){return r(y)}function r(i){return i>=0&&(A=i,f=h[A][0],p=(A||(u.loop?h.length:0))-1,y=(A+1)%h.length||(u.loop?0:-1),c(),x.className="lbLoading",N=new Image,N.onload=l,N.src=f),!1}function l(){x.className="",i(D).css({backgroundImage:"url("+f+")",visibility:"hidden",display:""}),i(k).width(N.width),i([k,L,T]).height(N.height),i(F).html(h[A][1]||""),i(H).html((h.length>1&&u.counterText||"").replace(/{x}/,A+1).replace(/{y}/,h.length)),p>=0&&(O.src=h[p][0]),y>=0&&(S.src=h[y][0]),v=D.offsetWidth,b=D.offsetHeight;var t=Math.max(0,g-b/2);x.offsetHeight!=b&&i(x).animate({height:b,top:t},u.resizeDuration,u.resizeEasing),x.offsetWidth!=v&&i(x).animate({width:v,marginLeft:-v/2},u.resizeDuration,u.resizeEasing),i(x).queue(function(){i(z).css({width:v,top:t+b,marginLeft:-v/2,visibility:"hidden",display:""}),i(D).css({display:"none",visibility:"",opacity:""}).fadeIn(u.imageFadeDuration,s)})}function s(){p>=0&&i(L).show(),y>=0&&i(T).show(),i(I).css("marginTop",-I.offsetHeight).animate({marginTop:0},u.captionAnimationDuration),z.style.visibility=""}function c(){N.onload=null,N.src=O.src=S.src=f,i([x,D,I]).stop(!0),i([L,T,D,z]).hide()}function d(){return A>=0&&(c(),A=p=y=-1,i(x).hide(),i(w).stop().fadeOut(u.overlayFadeDuration,e)),!1}var u,h,f,p,y,m,g,v,b,w,x,D,k,L,T,z,I,F,H,K=i(window),A=-1,C=!window.XMLHttpRequest,E=[],N=(document.documentElement,{}),O=new Image,S=new Image;i(function(){i("body").append(i([w=i('<div id="lbOverlay" />').click(d)[0],x=i('<div id="lbCenter" />')[0],z=i('<div id="lbBottomContainer" />')[0]]).css("display","none")),D=i('<div id="lbImage" />').appendTo(x).append(k=i('<div style="position: relative;" />').append([L=i('<a id="lbPrevLink" href="#" />').click(o)[0],T=i('<a id="lbNextLink" href="#" />').click(a)[0]])[0])[0],I=i('<div id="lbBottom" />').appendTo(z).append([i('<a id="lbCloseLink" href="#" />').click(d)[0],F=i('<div id="lbCaption" />')[0],H=i('<div id="lbNumber" />')[0],i('<div style="clear: both;" />')[0]])[0]}),i.slimbox=function(n,o,a){return u=i.extend({loop:!1,overlayOpacity:.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},a),"string"==typeof n&&(n=[[n,o]],o=0),g=K.scrollTop()+K.height()/2,v=u.initialWidth,b=u.initialHeight,i(x).css({top:Math.max(0,g-b/2),width:v,height:b,marginLeft:-v/2}).show(),m=C||w.currentStyle&&"fixed"!=w.currentStyle.position,m&&(w.style.position="absolute"),i(w).css("opacity",u.overlayOpacity).fadeIn(u.overlayFadeDuration),t(),e(1),h=n,u.loop=u.loop&&h.length>1,r(o)},i.fn.slimbox=function(t,e,n){e=e||function(i){return[i.href,i.title]},n=n||function(){return!0};var o=this;return o.unbind("click").click(function(){var a,r,l=this,s=0,c=0;for(a=i.grep(o,function(i,t){return n.call(l,i,t)}),r=a.length;r>c;++c)a[c]==l&&(s=c),a[c]=e(a[c],c);return i.slimbox(a,s,t)})}}(jQuery);